{"version":3,"file":"main.js","sources":["main.ts"],"sourcesContent":["import { App, Plugin, TFile, Notice, PluginSettingTab, Setting, normalizePath, Modal } from \"obsidian\";\n\ninterface DirectoryTagMapping {\n    directory: string;\n    tags: string[];\n}\n\ninterface FolderTagPluginSettings {\n    folderDepth: \"1\" | \"2split\" | \"2single\" | \"full\" | \"allsplit\";\n    tagPrefix: string;\n    tagSuffix: string;\n    directoryTagMappings: DirectoryTagMapping[];\n}\n\nconst DEFAULT_SETTINGS: FolderTagPluginSettings = {\n    folderDepth: \"1\",\n    tagPrefix: \"\",\n    tagSuffix: \"\",\n    directoryTagMappings: []\n};\n\nexport default class FolderTagPlugin extends Plugin {\n    settings!: FolderTagPluginSettings;\n\n    async onload() {\n        await this.loadSettings();\n        this.addSettingTab(new FolderTagSettingTab(this.app, this));\n\n        this.registerEvent(this.app.vault.on(\"create\", async (file) => {\n            if (file instanceof TFile && file.extension === \"md\") {\n                await this.applyFolderTag(file, \"create\");\n            }\n        }));\n\n        this.registerEvent(this.app.vault.on(\"rename\", async (file, oldPath) => {\n            if (file instanceof TFile && file.extension === \"md\") {\n                // Handle directory rename in settings\n                await this.handleDirectoryRename(oldPath, file.path);\n                \n                // Apply folder tags for the moved file\n                await this.applyFolderTag(file, \"move\", oldPath);\n            }\n        }));\n    }\n\n    async loadSettings() {\n        this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());\n    }\n\n    async saveSettings() {\n        await this.saveData(this.settings);\n    }\n\n    private getFolderTags(file: TFile): string[] {\n        return this.getFolderTagsFromPath(file.path);\n    }\n\n    private getFolderTagsFromPath(path: string): string[] {\n        const normalized = normalizePath(path);\n        const parts = normalized.split(\"/\").slice(0, -1);\n        if (!parts.length) return [];\n\n        const { folderDepth, tagPrefix, tagSuffix } = this.settings;\n        let tags: string[] = [];\n\n        switch (folderDepth) {\n            case \"1\":\n                tags.push(tagPrefix + parts[parts.length - 1] + tagSuffix);\n                break;\n            case \"2split\":\n                if (parts.length >= 2) {\n                    tags.push(tagPrefix + parts[parts.length - 1] + tagSuffix);\n                    tags.push(tagPrefix + parts[parts.length - 2] + tagSuffix);\n                } else {\n                    tags.push(tagPrefix + parts[parts.length - 1] + tagSuffix);\n                }\n                break;\n            case \"2single\":\n                if (parts.length >= 2) {\n                    tags.push(tagPrefix + parts[parts.length - 2] + \"/\" + parts[parts.length - 1] + tagSuffix);\n                } else {\n                    tags.push(tagPrefix + parts[parts.length - 1] + tagSuffix);\n                }\n                break;\n            case \"full\":\n                tags.push(tagPrefix + parts.join(\"/\") + tagSuffix);\n                break;\n            case \"allsplit\":\n                // Add each directory in the path as a separate tag\n                parts.forEach(part => {\n                    tags.push(tagPrefix + part + tagSuffix);\n                });\n                break;\n        }\n\n        return tags;\n    }\n\n    parseTagsFromString(tagsString: string): string[] {\n        return tagsString.split(\",\").map(t => t.trim()).filter(t => t.length > 0);\n    }\n\n    // -------------------------\n    // Handle directory rename in settings\n    // -------------------------\n    private async handleDirectoryRename(oldPath: string, newPath: string) {\n        const oldDir = normalizePath(oldPath).split(\"/\").slice(0, -1).join(\"/\");\n        const newDir = normalizePath(newPath).split(\"/\").slice(0, -1).join(\"/\");\n        \n        // Check if directory actually changed\n        if (oldDir === newDir) return;\n        \n        // Track if any mappings were updated\n        let updated = false;\n        \n        // Update any matching directory mappings\n        for (const mapping of this.settings.directoryTagMappings) {\n            const normalizedMapping = normalizePath(mapping.directory);\n            \n            // Check if the mapping matches the old directory or is a subdirectory of it\n            if (normalizedMapping === oldDir || normalizedMapping.startsWith(oldDir + \"/\")) {\n                // Replace the old directory path with the new one\n                const relativePath = normalizedMapping.substring(oldDir.length);\n                mapping.directory = newDir + relativePath;\n                updated = true;\n            }\n        }\n        \n        // Save settings if any mappings were updated\n        if (updated) {\n            await this.saveSettings();\n            new Notice(\"Directory mappings updated for renamed folder\");\n        }\n    }\n\n    private getCustomDirectoryTags(path: string): string[] {\n        const normalized = normalizePath(path);\n        const customTags: string[] = [];\n        \n        // Get the directory path (remove the filename)\n        const dirPath = normalized.split(\"/\").slice(0, -1).join(\"/\");\n        \n        // Check each directory in the path against custom mappings\n        for (const mapping of this.settings.directoryTagMappings) {\n            const normalizedDir = normalizePath(mapping.directory);\n            \n            // Skip empty directory mappings\n            if (!normalizedDir) continue;\n            \n            // Check if the file is within this directory\n            // Either the dir path equals the mapping directory, or it's a subdirectory\n            if (dirPath === normalizedDir || dirPath.startsWith(normalizedDir + \"/\")) {\n                customTags.push(...mapping.tags);\n            }\n        }\n        \n        return customTags;\n    }\n\n    private getAllTags(path: string): string[] {\n        const folderTags = this.getFolderTagsFromPath(path);\n        const customTags = this.getCustomDirectoryTags(path);\n        \n        // Combine and deduplicate tags\n        const allTags = [...folderTags, ...customTags];\n        return [...new Set(allTags)];\n    }\n\n    // -------------------------\n    // Apply folder tags\n    // -------------------------\n    async applyFolderTag(file: TFile, action: \"create\" | \"move\" | \"rerun\", oldPath?: string) {\n        const folderTags = this.getAllTags(file.path);\n        if (!folderTags.length) return;\n\n        await this.app.fileManager.processFrontMatter(file, yaml => {\n            if (!yaml || typeof yaml !== \"object\") return;\n\n            let existingTags: string[] = [];\n            if (\"tags\" in yaml) {\n                if (Array.isArray(yaml.tags)) existingTags.push(...yaml.tags.map((t: string | number) => String(t).trim()));\n                else if (typeof yaml.tags === \"string\") existingTags.push(...yaml.tags.split(\",\").map((t: string) => t.trim()));\n            }\n\n            // Remove old folder tags if moving/rerunning\n            if (action === \"move\" && oldPath) {\n                // For move: remove tags based on the old file path\n                const oldTags = this.getAllTags(oldPath);\n                existingTags = existingTags.filter(t => !oldTags.includes(t));\n            } else if (action === \"rerun\") {\n                // For rerun: remove tags based on current path (to handle setting changes)\n                // This ensures tags are refreshed when depth setting changes\n                const currentTags = this.getAllTags(file.path);\n                existingTags = existingTags.filter(t => !currentTags.includes(t));\n            }\n\n            // Add new folder tags\n            folderTags.forEach(t => { if (!existingTags.includes(t)) existingTags.push(t); });\n\n            yaml.tags = existingTags;\n        });\n    }\n\n\n    // -------------------------\n    // Remove folder tags\n    // -------------------------\n    async removeFolderTags(file: TFile) {\n        const folderTags = this.getAllTags(file.path);\n        if (!folderTags.length) return;\n\n        await this.app.fileManager.processFrontMatter(file, yaml => {\n            if (!yaml || typeof yaml !== \"object\") return;\n\n            let existingTags: string[] = [];\n            if (\"tags\" in yaml) {\n                const val = yaml.tags;\n                if (Array.isArray(val)) existingTags.push(...val.map(v => String(v).trim()));\n                else if (typeof val === \"string\") existingTags.push(...val.split(\",\").map(v => v.trim()));\n            }\n\n            existingTags = existingTags.filter(t => !folderTags.includes(t));\n\n            if (existingTags.length === 0) delete yaml.tags;\n            else yaml.tags = existingTags;\n        });\n    }\n\n    // -------------------------\n    // Remove only custom directory tags (safe removal)\n    // -------------------------\n    async removeCustomDirectoryTags(file: TFile) {\n        const customTags = this.getCustomDirectoryTags(file.path);\n        if (!customTags.length) return;\n\n        await this.app.fileManager.processFrontMatter(file, yaml => {\n            if (!yaml || typeof yaml !== \"object\") return;\n\n            let existingTags: string[] = [];\n            if (\"tags\" in yaml) {\n                const val = yaml.tags;\n                if (Array.isArray(val)) existingTags.push(...val.map(v => String(v).trim()));\n                else if (typeof val === \"string\") existingTags.push(...val.split(\",\").map(v => v.trim()));\n            }\n\n            // Only remove custom directory tags, preserve folder-based tags\n            existingTags = existingTags.filter(t => !customTags.includes(t));\n\n            if (existingTags.length === 0) delete yaml.tags;\n            else yaml.tags = existingTags;\n        });\n    }\n\n    // -------------------------\n    // Remove tags for a specific directory mapping\n    // -------------------------\n    async removeTagsForMapping(mapping: DirectoryTagMapping) {\n        const files = this.app.vault.getMarkdownFiles();\n        let removedCount = 0;\n\n        for (const file of files) {\n            const normalized = normalizePath(file.path);\n            const dirPath = normalized.split(\"/\").slice(0, -1).join(\"/\");\n            const normalizedDir = normalizePath(mapping.directory);\n\n            // Check if file is in this directory\n            if (dirPath === normalizedDir || dirPath.startsWith(normalizedDir + \"/\")) {\n                await this.app.fileManager.processFrontMatter(file, yaml => {\n                    if (!yaml || typeof yaml !== \"object\") return;\n\n                    let existingTags: string[] = [];\n                    if (\"tags\" in yaml) {\n                        const val = yaml.tags;\n                        if (Array.isArray(val)) existingTags.push(...val.map(v => String(v).trim()));\n                        else if (typeof val === \"string\") existingTags.push(...val.split(\",\").map(v => v.trim()));\n                    }\n\n                    const originalLength = existingTags.length;\n                    // Remove only the tags from this mapping\n                    existingTags = existingTags.filter(t => !mapping.tags.includes(t));\n\n                    if (existingTags.length < originalLength) {\n                        removedCount++;\n                    }\n\n                    if (existingTags.length === 0) delete yaml.tags;\n                    else yaml.tags = existingTags;\n                });\n            }\n        }\n\n        return removedCount;\n    }\n\n    // -------------------------\n    // Apply tags for a specific directory mapping to existing notes\n    // -------------------------\n    async applyTagsForMapping(mapping: DirectoryTagMapping) {\n        if (!mapping.directory || mapping.tags.length === 0) {\n            return 0;\n        }\n\n        const files = this.app.vault.getMarkdownFiles();\n        let appliedCount = 0;\n\n        for (const file of files) {\n            const normalized = normalizePath(file.path);\n            const dirPath = normalized.split(\"/\").slice(0, -1).join(\"/\");\n            const normalizedDir = normalizePath(mapping.directory);\n\n            // Check if file is in this directory\n            if (dirPath === normalizedDir || dirPath.startsWith(normalizedDir + \"/\")) {\n                await this.app.fileManager.processFrontMatter(file, yaml => {\n                    if (!yaml || typeof yaml !== \"object\") return;\n\n                    let existingTags: string[] = [];\n                    if (\"tags\" in yaml) {\n                        const val = yaml.tags;\n                        if (Array.isArray(val)) existingTags.push(...val.map(v => String(v).trim()));\n                        else if (typeof val === \"string\") existingTags.push(...val.split(\",\").map(v => v.trim()));\n                    }\n\n                    const originalLength = existingTags.length;\n                    // Add tags from this mapping\n                    mapping.tags.forEach(tag => {\n                        if (!existingTags.includes(tag)) {\n                            existingTags.push(tag);\n                        }\n                    });\n\n                    if (existingTags.length > originalLength) {\n                        appliedCount++;\n                    }\n\n                    yaml.tags = existingTags;\n                });\n            }\n        }\n\n        return appliedCount;\n    }\n\n    // -------------------------\n    // Update tags when mapping tags are changed\n    // -------------------------\n    async updateTagsForMapping(mapping: DirectoryTagMapping, oldTags: string[]) {\n        if (!mapping.directory) {\n            return 0;\n        }\n\n        const files = this.app.vault.getMarkdownFiles();\n        let updatedCount = 0;\n\n        for (const file of files) {\n            const normalized = normalizePath(file.path);\n            const dirPath = normalized.split(\"/\").slice(0, -1).join(\"/\");\n            const normalizedDir = normalizePath(mapping.directory);\n\n            // Check if file is in this directory\n            if (dirPath === normalizedDir || dirPath.startsWith(normalizedDir + \"/\")) {\n                await this.app.fileManager.processFrontMatter(file, yaml => {\n                    if (!yaml || typeof yaml !== \"object\") return;\n\n                    let existingTags: string[] = [];\n                    if (\"tags\" in yaml) {\n                        const val = yaml.tags;\n                        if (Array.isArray(val)) existingTags.push(...val.map(v => String(v).trim()));\n                        else if (typeof val === \"string\") existingTags.push(...val.split(\",\").map(v => v.trim()));\n                    }\n\n                    let modified = false;\n\n                    // Remove old tags\n                    const beforeRemoval = existingTags.length;\n                    existingTags = existingTags.filter(t => !oldTags.includes(t));\n                    if (existingTags.length < beforeRemoval) {\n                        modified = true;\n                    }\n\n                    // Add new tags\n                    mapping.tags.forEach(tag => {\n                        if (!existingTags.includes(tag)) {\n                            existingTags.push(tag);\n                            modified = true;\n                        }\n                    });\n\n                    if (modified) {\n                        updatedCount++;\n                    }\n\n                    if (existingTags.length === 0) delete yaml.tags;\n                    else yaml.tags = existingTags;\n                });\n            }\n        }\n\n        return updatedCount;\n    }\n}\n\n// -------------------------\n// Confirmation Modal\n// -------------------------\nclass ConfirmationModal extends Modal {\n    message: string;\n    onConfirm: () => void;\n\n    constructor(app: App, message: string, onConfirm: () => void) {\n        super(app);\n        this.message = message;\n        this.onConfirm = onConfirm;\n    }\n\n    onOpen() {\n        const { contentEl } = this;\n        contentEl.empty();\n        \n        contentEl.createEl(\"h2\", { text: \"Confirm action\" });\n        contentEl.createEl(\"p\", { text: this.message });\n        \n        const buttonContainer = contentEl.createDiv({ cls: \"modal-button-container\" });\n        \n        const confirmBtn = buttonContainer.createEl(\"button\", { \n            text: \"Confirm\",\n            cls: \"mod-cta\"\n        });\n        confirmBtn.addEventListener(\"click\", () => {\n            this.close();\n            this.onConfirm();\n        });\n        \n        const cancelBtn = buttonContainer.createEl(\"button\", { \n            text: \"Cancel\"\n        });\n        cancelBtn.addEventListener(\"click\", () => {\n            this.close();\n        });\n    }\n\n    onClose() {\n        const { contentEl } = this;\n        contentEl.empty();\n    }\n}\n\n// -------------------------\n// Settings Tab\n// -------------------------\nclass FolderTagSettingTab extends PluginSettingTab {\n    plugin: FolderTagPlugin;\n\n    constructor(app: App, plugin: FolderTagPlugin) {\n        super(app, plugin);\n        this.plugin = plugin;\n    }\n\n    displayDirectoryMappings(containerEl: HTMLElement): void {\n        this.plugin.settings.directoryTagMappings.forEach((mapping, index) => {\n            // Store original tags to detect changes\n            const originalTags = [...mapping.tags];\n            \n            const setting = new Setting(containerEl)\n                .setClass(\"directory-mapping-item\")\n                .addText(text => text\n                    .setPlaceholder(\"Directory path (e.g., php-aws-sdk)\")\n                    .setValue(mapping.directory)\n                    .onChange(async (value) => {\n                        mapping.directory = value;\n                        await this.plugin.saveSettings();\n                    })\n                )\n                .addText(text => text\n                    .setPlaceholder(\"Tags (comma-separated, e.g., php, aws)\")\n                    .setValue(mapping.tags.join(\", \"))\n                    .onChange(async (value) => {\n                        const newTags = this.plugin.parseTagsFromString(value);\n                        \n                        // Check if tags actually changed\n                        const tagsChanged = JSON.stringify(originalTags.sort()) !== JSON.stringify(newTags.sort());\n                        \n                        if (tagsChanged && originalTags.length > 0 && mapping.directory) {\n                            // Ask user if they want to update existing notes\n                            const message = `Update tags in existing notes?\\n\\nOld tags: [${originalTags.join(\", \")}]\\nNew tags: [${newTags.join(\", \")}]\\n\\nThis will update all notes in \"${mapping.directory}\".`;\n                            \n                            new ConfirmationModal(this.app, message, async () => {\n                                new Notice(\"Updating tags in notes...\");\n                                mapping.tags = newTags;\n                                const updatedCount = await this.plugin.updateTagsForMapping(mapping, originalTags);\n                                await this.plugin.saveSettings();\n                                new Notice(`Tags updated in ${updatedCount} note(s).`);\n                                this.display();\n                            }).open();\n                        } else {\n                            mapping.tags = newTags;\n                            await this.plugin.saveSettings();\n                        }\n                    })\n                )\n                .addButton(btn => btn\n                    .setButtonText(\"Apply\")\n                    .setTooltip(\"Apply these tags to existing notes in this directory\")\n                    .onClick(async () => {\n                        if (!mapping.directory || mapping.tags.length === 0) {\n                            new Notice(\"Please set directory path and tags first.\");\n                            return;\n                        }\n                        \n                        new Notice(\"Applying tags to existing notes...\");\n                        const appliedCount = await this.plugin.applyTagsForMapping(mapping);\n                        new Notice(`Tags applied to ${appliedCount} note(s).`);\n                    })\n                )\n                .addButton(btn => btn\n                    .setButtonText(\"Remove\")\n                    .setWarning()\n                    .onClick(async () => {\n                        const mappingToRemove = mapping;\n                        const message = `Remove directory mapping \"${mappingToRemove.directory}\" → [${mappingToRemove.tags.join(\", \")}]?\\n\\nThis will also remove these tags from all notes in this directory.`;\n                        \n                        new ConfirmationModal(this.app, message, async () => {\n                            new Notice(\"Removing tags from notes...\");\n                            \n                            // Remove tags from notes first\n                            const removedCount = await this.plugin.removeTagsForMapping(mappingToRemove);\n                            \n                            // Then remove the mapping from settings\n                            this.plugin.settings.directoryTagMappings.splice(index, 1);\n                            await this.plugin.saveSettings();\n                            \n                            new Notice(`Mapping removed. Tags removed from ${removedCount} note(s).`);\n                            this.display();\n                        }).open();\n                    })\n                );\n        });\n    }\n\n    display(): void {\n        const { containerEl } = this;\n        containerEl.empty();\n        new Setting(containerEl).setHeading().setName(\"Folder to tag\");\n\n        new Setting(containerEl)\n            .setName(\"Folder depth\")\n            .addDropdown(drop => {\n                drop.addOption(\"1\", \"Depth 1\")\n                    .addOption(\"2split\", \"Depth 2 (separate tags)\")\n                    .addOption(\"2single\", \"Depth 2 in one tag\")\n                    .addOption(\"full\", \"Full path\")\n                    .addOption(\"allsplit\", \"All directories (separate tags)\")\n                    .setValue(this.plugin.settings.folderDepth)\n                    .onChange(async value => {\n                        this.plugin.settings.folderDepth = value as FolderTagPluginSettings[\"folderDepth\"];\n                        await this.plugin.saveSettings();\n                    });\n            });\n\n        new Setting(containerEl)\n            .setName(\"Tag prefix\")\n            .addText(txt => txt\n                .setValue(this.plugin.settings.tagPrefix)\n                .onChange(async value => {\n                    this.plugin.settings.tagPrefix = value;\n                    await this.plugin.saveSettings();\n                })\n            );\n\n        new Setting(containerEl)\n            .setName(\"Tag suffix\")\n            .addText(txt => txt\n                .setValue(this.plugin.settings.tagSuffix)\n                .onChange(async value => {\n                    this.plugin.settings.tagSuffix = value;\n                    await this.plugin.saveSettings();\n                })\n            );\n\n        // Custom Directory Tags Section\n        new Setting(containerEl).setHeading().setName(\"Custom directory tags\");\n        \n        new Setting(containerEl)\n            .setName(\"Directory tag mappings\")\n            .setDesc(\"Add custom tags for specific directories. Example: 'php-aws-sdk' → tags: 'php, aws'\");\n\n        this.displayDirectoryMappings(containerEl);\n\n        new Setting(containerEl)\n            .addButton(btn => btn\n                .setButtonText(\"Add directory mapping\")\n                .onClick(async () => {\n                    this.plugin.settings.directoryTagMappings.push({\n                        directory: \"\",\n                        tags: []\n                    });\n                    await this.plugin.saveSettings();\n                    this.display();\n                })\n            );\n\n        new Setting(containerEl)\n            .setName(\"Remove custom directory tags from all notes\")\n            .setDesc(\"Safely removes only custom directory tags, preserving folder-based tags\")\n            .addButton(btn => btn\n                .setButtonText(\"Remove custom tags\")\n                .setWarning()\n                .onClick(async () => {\n                    new Notice(\"Removing custom directory tags from all notes...\");\n                    const files = this.plugin.app.vault.getMarkdownFiles();\n                    for (const file of files) {\n                        await this.plugin.removeCustomDirectoryTags(file);\n                    }\n                    new Notice(\"Custom directory tags removed!\");\n                })\n            );\n\n        new Setting(containerEl)\n            .setName(\"Reapply tags to all notes\")\n            .addButton(btn => btn\n                .setButtonText(\"Reapply to all notes\")\n                .setCta()\n                .onClick(async () => {\n                    new Notice(\"Updating all notes...\");\n                    const files = this.plugin.app.vault.getMarkdownFiles();\n                    for (const file of files) {\n                        try {\n                            await this.plugin.applyFolderTag(file, \"rerun\");\n                        } catch (e) {\n                            console.error(\"Failed for file:\", file.path, e);\n                            new Notice(`Failed to process: ${file.path}`);\n                        }\n                    }\n                    new Notice(\"Folder tags updated for all notes!\");\n                })\n            );\n\n\n        new Setting(containerEl)\n            .setName(\"Remove all folder tags\")\n            .addButton(btn => btn\n                .setButtonText(\"Remove folder tags\")\n                .setCta()\n                .onClick(async () => {\n                    new Notice(\"Removing folder tags from all notes...\");\n                    const files = this.plugin.app.vault.getMarkdownFiles();\n                    for (const file of files) {\n                        await this.plugin.removeFolderTags(file);\n                    }\n                    new Notice(\"All folder tags removed!\");\n                })\n            );\n    }\n}\n"],"names":["Plugin","TFile","normalizePath","Notice","Modal","PluginSettingTab","Setting"],"mappings":"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"}